"use strict";
function getRandomColor() {
    var rgb = [];
    for (var i = 0; i < 3; ++i) {
        var color = Math.floor(Math.random() * 256).toString(16);
        color = color.length == 1 ? '0' + color : color;
        rgb.push(color);
    }
    return '#' + rgb.join('');
}
Page({
    onReady: function () {
        this.videoContext = wx.createVideoContext('myVideo');
    },
    inputValue: '',
    videoContext: {},
    data: {
        url: '',
        courseName: '',
        danmuList: [
            {
                text: '第 1s 出现的弹幕',
                color: '#ff0000',
                time: 1
            },
            {
                text: '第 3s 出现的弹幕',
                color: '#ff00ff',
                time: 3
            }
        ]
    },
    onLoad: function () {
        try {
            var coursename = wx.getStorageSync('name');
            var ur = wx.getStorageSync('url');
            this.setData({
                courseName: coursename,
                url: 'http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4'
            });
            wx.setStorageSync('lastTime', 0);
        }
        catch (e) {
        }
    },
    bindInputBlur: function (e) {
        this.inputValue = e.detail.value;
    },
    bindSendDanmu: function () {
        this.videoContext.sendDanmu({
            text: this.inputValue,
            color: getRandomColor()
        });
    },
    timeUpdate: function (e) {
        var lastTime = wx.getStorageSync('lastTime');
        if (Math.abs(e.detail.currentTime - lastTime) > 2) {
            this.videoContext.seek(lastTime);
            return;
        }
        wx.setStorageSync('lastTime', e.detail.currentTime);
    },
    finish: function () {
        console.log('finish');
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlkZW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aWRlby50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsU0FBUyxjQUFjO0lBQ25CLElBQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQTtJQUNkLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDeEIsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQ3hELEtBQUssR0FBRyxLQUFLLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFBO1FBQy9DLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7S0FDbEI7SUFDRCxPQUFPLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0FBQzdCLENBQUM7QUFFRCxJQUFJLENBQUM7SUFDRCxPQUFPO1FBQ0gsSUFBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUE7SUFDeEQsQ0FBQztJQUNELFVBQVUsRUFBRSxFQUFFO0lBQ2QsWUFBWSxFQUFtQixFQUFFO0lBQ2pDLElBQUksRUFBRTtRQUNGLEdBQUcsRUFBRSxFQUFFO1FBQ1AsVUFBVSxFQUFFLEVBQUU7UUFDZCxTQUFTLEVBQUU7WUFDUDtnQkFDSSxJQUFJLEVBQUUsWUFBWTtnQkFDbEIsS0FBSyxFQUFFLFNBQVM7Z0JBQ2hCLElBQUksRUFBRSxDQUFDO2FBQ1Y7WUFDRDtnQkFDSSxJQUFJLEVBQUUsWUFBWTtnQkFDbEIsS0FBSyxFQUFFLFNBQVM7Z0JBQ2hCLElBQUksRUFBRSxDQUFDO2FBQ1Y7U0FDSjtLQUNKO0lBQ0QsTUFBTTtRQUNGLElBQUk7WUFDQSxJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFBO1lBQzFDLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUE7WUFDakMsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDVCxVQUFVLEVBQUUsVUFBVTtnQkFDdEIsR0FBRyxFQUFFLG1EQUFtRDthQUMzRCxDQUFDLENBQUE7WUFDRixFQUFFLENBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQTtTQUNuQztRQUFDLE9BQU8sQ0FBQyxFQUFFO1NBRVg7SUFDTCxDQUFDO0lBQ0QsYUFBYSxZQUFDLENBQU07UUFDaEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQTtJQUNwQyxDQUFDO0lBQ0QsYUFBYTtRQUNULElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDO1lBQ3hCLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVTtZQUNyQixLQUFLLEVBQUUsY0FBYyxFQUFFO1NBQzFCLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFDRCxVQUFVLFlBQUMsQ0FBMEU7UUFDakYsSUFBSSxRQUFRLEdBQUcsRUFBRSxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQTtRQUM1QyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBRS9DLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQ2hDLE9BQU07U0FDVDtRQUNELEVBQUUsQ0FBQyxjQUFjLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDdkQsQ0FBQztJQUNELE1BQU07UUFDRixPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0lBQ3pCLENBQUM7Q0FDSixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBnZXRSYW5kb21Db2xvcigpIHtcclxuICAgIGNvbnN0IHJnYiA9IFtdXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7ICsraSkge1xyXG4gICAgICAgIGxldCBjb2xvciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI1NikudG9TdHJpbmcoMTYpXHJcbiAgICAgICAgY29sb3IgPSBjb2xvci5sZW5ndGggPT0gMSA/ICcwJyArIGNvbG9yIDogY29sb3JcclxuICAgICAgICByZ2IucHVzaChjb2xvcilcclxuICAgIH1cclxuICAgIHJldHVybiAnIycgKyByZ2Iuam9pbignJylcclxufVxyXG5cclxuUGFnZSh7XHJcbiAgICBvblJlYWR5KCkge1xyXG4gICAgICAgIHRoaXMudmlkZW9Db250ZXh0ID0gd3guY3JlYXRlVmlkZW9Db250ZXh0KCdteVZpZGVvJylcclxuICAgIH0sXHJcbiAgICBpbnB1dFZhbHVlOiAnJyxcclxuICAgIHZpZGVvQ29udGV4dDogPHd4LlZpZGVvQ29udGV4dD57fSxcclxuICAgIGRhdGE6IHtcclxuICAgICAgICB1cmw6ICcnLFxyXG4gICAgICAgIGNvdXJzZU5hbWU6ICcnLFxyXG4gICAgICAgIGRhbm11TGlzdDogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAn56ysIDFzIOWHuueOsOeahOW8ueW5lScsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogJyNmZjAwMDAnLFxyXG4gICAgICAgICAgICAgICAgdGltZTogMVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAn56ysIDNzIOWHuueOsOeahOW8ueW5lScsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogJyNmZjAwZmYnLFxyXG4gICAgICAgICAgICAgICAgdGltZTogM1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXVxyXG4gICAgfSxcclxuICAgIG9uTG9hZCgpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgY291cnNlbmFtZSA9IHd4LmdldFN0b3JhZ2VTeW5jKCduYW1lJylcclxuICAgICAgICAgICAgbGV0IHVyID0gd3guZ2V0U3RvcmFnZVN5bmMoJ3VybCcpXHJcbiAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICBjb3Vyc2VOYW1lOiBjb3Vyc2VuYW1lLFxyXG4gICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2NsaXBzLnZvcndhZXJ0cy1nbWJoLmRlL2JpZ19idWNrX2J1bm55Lm1wNCcvL3VyIC8vIOWPr+eUqOa1i+ivleinhumikSdodHRwOi8vY2xpcHMudm9yd2FlcnRzLWdtYmguZGUvYmlnX2J1Y2tfYnVubnkubXA0J1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB3eC5zZXRTdG9yYWdlU3luYygnbGFzdFRpbWUnLCAwKVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgLy9UT0RPXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGJpbmRJbnB1dEJsdXIoZTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dFZhbHVlID0gZS5kZXRhaWwudmFsdWVcclxuICAgIH0sXHJcbiAgICBiaW5kU2VuZERhbm11KCkge1xyXG4gICAgICAgIHRoaXMudmlkZW9Db250ZXh0LnNlbmREYW5tdSh7XHJcbiAgICAgICAgICAgIHRleHQ6IHRoaXMuaW5wdXRWYWx1ZSxcclxuICAgICAgICAgICAgY29sb3I6IGdldFJhbmRvbUNvbG9yKClcclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuICAgIHRpbWVVcGRhdGUoZTogd3guQ3VzdG9tRXZlbnQ8J3RpbWV1cGRhdGUnLCB7IGN1cnJlbnRUaW1lOiBudW1iZXI7IGR1cmF0aW9uOiBudW1iZXIgfT4pIHtcclxuICAgICAgICBsZXQgbGFzdFRpbWUgPSB3eC5nZXRTdG9yYWdlU3luYygnbGFzdFRpbWUnKVxyXG4gICAgICAgIGlmIChNYXRoLmFicyhlLmRldGFpbC5jdXJyZW50VGltZSAtIGxhc3RUaW1lKSA+IDIpIHtcclxuICAgICAgICAgICAgLy8g6Ziy5ouW5YqoXHJcbiAgICAgICAgICAgIHRoaXMudmlkZW9Db250ZXh0LnNlZWsobGFzdFRpbWUpXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICB3eC5zZXRTdG9yYWdlU3luYygnbGFzdFRpbWUnLCBlLmRldGFpbC5jdXJyZW50VGltZSlcclxuICAgIH0sXHJcbiAgICBmaW5pc2goKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2ZpbmlzaCcpXHJcbiAgICB9XHJcbn0pXHJcbiJdfQ==